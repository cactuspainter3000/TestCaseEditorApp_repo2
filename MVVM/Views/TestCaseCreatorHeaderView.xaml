<UserControl x:Class="TestCaseEditorApp.MVVM.Views.TestCaseCreatorHeaderView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:vm="clr-namespace:TestCaseEditorApp.MVVM.ViewModels"
             mc:Ignorable="d"
             d:DesignHeight="75" d:DesignWidth="800">
    <DockPanel LastChildFill="True" Margin="6" VerticalAlignment="Center">
        <!-- Left: File menu in header (Test Case Creator specific) -->
        <StackPanel Orientation="Horizontal" DockPanel.Dock="Left" VerticalAlignment="Center" Margin="0,0,12,0">
            <ToggleButton x:Name="HeaderFileToggle" Style="{StaticResource MenuHeaderToggleStyle}" Cursor="Hand">
                <TextBlock Text="File" Style="{StaticResource MenuHeaderTheme}" />
            </ToggleButton>

            <Popup IsOpen="{Binding IsChecked, ElementName=HeaderFileToggle, Mode=TwoWay}"
                   PlacementTarget="{Binding ElementName=HeaderFileToggle}"
                   Placement="Bottom"
                   StaysOpen="False"
                   AllowsTransparency="True"
                   Focusable="False">
                <Border Background="{StaticResource MenuListBackground}"
                        BorderBrush="#33000000"
                        BorderThickness="1"
                        CornerRadius="4"
                        Padding="6"
                        MinWidth="240"
                        SnapsToDevicePixels="True">
                    <StackPanel>
                        <Button Command="{Binding ImportWordCommand}" Style="{StaticResource MenuPopupButtonStyle}">
                            <TextBlock Text="Import New Requirements…" />
                        </Button>

                        <Button Command="{Binding LoadWorkspaceCommand}" Style="{StaticResource MenuPopupButtonStyle}">
                            <TextBlock Text="Import In-Process Requirements…" />
                        </Button>

                        <Separator Margin="0,6"/>

                        <Button Command="{Binding SaveWorkspaceCommand}" Style="{StaticResource MenuPopupButtonStyle}">
                            <TextBlock Text="Save Workspace" />
                        </Button>

                        <Separator Margin="0,6"/>

                        <Button Command="{Binding ReloadCommand}" Style="{StaticResource MenuPopupButtonStyle}">
                            <TextBlock Text="Reload Source (from DOCX)" />
                        </Button>

                        <Button Command="{Binding ExportAllToJamaCommand}" Style="{StaticResource MenuPopupButtonStyle}">
                            <TextBlock Text="Export All to Jama…" />
                        </Button>

                        <Separator Margin="0,8"/>

                        <Button Command="{Binding HelpCommand}" Style="{StaticResource MenuPopupButtonStyle}">
                            <TextBlock Text="Help" />
                        </Button>
                    </StackPanel>
                </Border>
            </Popup>
        </StackPanel>

        <!-- Center: workspace name + requirement info (binds to TestCaseCreatorHeaderViewModel) -->
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
            <TextBlock Text="{Binding WorkspaceName}" FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,8,0"/>
            <TextBlock Text="•" Margin="0,0,8,0" VerticalAlignment="Center"/>
            <TextBlock Text="{Binding CurrentRequirementName}" VerticalAlignment="Center" Margin="0,0,8,0"/>
            <TextBlock Text="(" VerticalAlignment="Center"/>
            <TextBlock Text="{Binding RequirementsWithTestCasesCount}" VerticalAlignment="Center" />
            <TextBlock Text=" with test cases)" VerticalAlignment="Center" Margin="4,0,0,0"/>
        </StackPanel>

    </DockPanel>
</UserControl>