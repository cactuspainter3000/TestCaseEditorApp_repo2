using System;
using System.Collections.Generic;
using System.Threading;
using System.Threading.Tasks;
using TestCaseEditorApp.Infrastructure.CQRS;
// Note: These would be actual ML service interfaces in a full implementation
// using TestCaseEditorApp.Infrastructure.AI.ML;
// using TestCaseEditorApp.Infrastructure.AI.Intelligence;
// using TestCaseEditorApp.Infrastructure.AI.Analytics;

namespace TestCaseEditorApp.Infrastructure.AI.Workflow
{
    // ==========================================
    // PLACEHOLDER INTERFACES FOR BUILD COMPATIBILITY
    // ==========================================
    
    // These interfaces would be implemented in separate ML infrastructure
    public interface IMLModelRepository { }
    public interface IMLModelTrainer { }
    public interface IIntelligentRequirementAnalyzer { }
    public interface IIntelligentTestCaseGenerator { }
    public interface INLPService { }
    public interface IAnalyticsDashboardService { }
    public interface IEventStore { Task SaveEventAsync(object domainEvent, CancellationToken cancellationToken); }
    public interface ISecurityContext { Task EnsurePermissionAsync(string permission, CancellationToken cancellationToken); }
    public interface IMetricsCollector { Task RecordMetricAsync(MetricData metric, CancellationToken cancellationToken); }
    public interface ICacheService { 
        Task<T> GetAsync<T>(string key, CancellationToken cancellationToken); 
        Task SetAsync<T>(string key, T value, TimeSpan expiration, CancellationToken cancellationToken);
        Task RemoveAsync(string key, CancellationToken cancellationToken);
        Task InvalidatePatternAsync(string pattern, CancellationToken cancellationToken);
    }
    public class MetricData { public string Name { get; set; } = string.Empty; public object Value { get; set; } = new(); public Dictionary<string, object> Tags { get; set; } = new(); }
    public interface IHealthCheck { Task<HealthCheckResult> CheckHealthAsync(HealthCheckContext context, CancellationToken cancellationToken); }
    public class DomainEvent { }
    public class DistributedTraceAttribute : Attribute { }
    public class User { public string Id { get; set; } = string.Empty; public string Name { get; set; } = string.Empty; }
    public class HealthCheckResult { public bool IsHealthy { get; set; } }
    public class HealthCheckContext { public Dictionary<string, object> Data { get; set; } = new(); }
    public static class ObservabilityManager { public static IDisposable StartActivity(string name, object data) => new DisposableStub(); }
    public class DisposableStub : IDisposable { public void Dispose() { } }
    
    // ASP.NET Core placeholder types
    public delegate Task RequestDelegate(HttpContext context);
    public class PathString { public string Value { get; set; } = string.Empty; }
    public class HttpClient : IDisposable { public void Dispose() { } }
    public class HttpResponseMessage : IDisposable { public void Dispose() { } }
    public class HttpContext { public Dictionary<string, object> Items { get; set; } = new(); }
    public interface IApplicationBuilder { IApplicationBuilder Use(Func<RequestDelegate, RequestDelegate> middleware); }
    public interface IHubContext<THub, TClient> { TClient Clients { get; } }
    public class Hub<T> { }
    public enum LoadBalancingAlgorithm { RoundRobin, LeastConnections, WeightedRoundRobin }
    
    // Test Generation Types
    public class TestOptimizationRequest { }
    public class TestPrioritizationContext { }
    public class RedundancyAnalysisContext { }
    public class ConsolidationAnalysisContext { }
    public class TestConsolidation { }
    public class PriorityFactor { }
    public class BusinessImpact { }
    public class TechnicalRisk { }
    public class ExecutionCost { }
    public class OptimizedTestSuite { }
    public class OptimizationStatistics { }
    public class PerformanceImprovements { }
    public class OptimizationRiskAnalysis { }
    public class OptimizationRecommendation { }
    public class SimilarTest { }
    public class RemovalImpact { }
    
    // ==========================================
    // WORKFLOW INTEGRATION INTERFACES
    // ==========================================

    /// <summary>
    /// ML workflow integration service interface
    /// </summary>
    public interface IMLWorkflowIntegrationService
    {
        /// <summary>
        /// Initialize ML workflows for a project
        /// </summary>
        Task<WorkflowInitializationResult> InitializeMLWorkflowsAsync(MLWorkflowInitializationRequest request, 
            CancellationToken cancellationToken = default);

        /// <summary>
        /// Execute ML workflow step
        /// </summary>
        Task<WorkflowStepResult> ExecuteWorkflowStepAsync(WorkflowStepRequest request, 
            CancellationToken cancellationToken = default);

        /// <summary>
        /// Get workflow execution status
        /// </summary>
        Task<WorkflowExecutionStatus> GetWorkflowStatusAsync(string workflowId, 
            CancellationToken cancellationToken = default);

        /// <summary>
        /// Trigger automated ML processes
        /// </summary>
        Task<AutomationTriggerResult> TriggerAutomatedProcessesAsync(AutomationTriggerRequest request, 
            CancellationToken cancellationToken = default);

        /// <summary>
        /// Get available ML workflows
        /// </summary>
        Task<List<MLWorkflowDefinition>> GetAvailableWorkflowsAsync(string projectId, 
            CancellationToken cancellationToken = default);
    }

    /// <summary>
    /// Auto-training pipeline service interface
    /// </summary>
    public interface IAutoTrainingPipelineService
    {
        /// <summary>
        /// Setup auto-training pipeline for a project
        /// </summary>
        Task<PipelineSetupResult> SetupAutoTrainingPipelineAsync(PipelineSetupRequest request, 
            CancellationToken cancellationToken = default);

        /// <summary>
        /// Start training pipeline execution
        /// </summary>
        Task<TrainingExecutionResult> StartTrainingPipelineAsync(TrainingPipelineRequest request, 
            CancellationToken cancellationToken = default);

        /// <summary>
        /// Monitor training pipeline progress
        /// </summary>
        Task<TrainingProgressStatus> GetTrainingProgressAsync(string pipelineId, 
            CancellationToken cancellationToken = default);

        /// <summary>
        /// Configure auto-training triggers
        /// </summary>
        Task<TriggerConfigurationResult> ConfigureAutoTrainingTriggersAsync(TriggerConfigurationRequest request, 
            CancellationToken cancellationToken = default);

        /// <summary>
        /// Get training pipeline history
        /// </summary>
        Task<List<TrainingHistoryRecord>> GetTrainingHistoryAsync(TrainingHistoryRequest request, 
            CancellationToken cancellationToken = default);
    }

    /// <summary>
    /// Production deployment service interface
    /// </summary>
    public interface IProductionDeploymentService
    {
        /// <summary>
        /// Deploy AI features to production
        /// </summary>
        Task<DeploymentResult> DeployAIFeaturesAsync(DeploymentRequest request, 
            CancellationToken cancellationToken = default);

        /// <summary>
        /// Rollback AI feature deployment
        /// </summary>
        Task<RollbackResult> RollbackDeploymentAsync(RollbackRequest request, 
            CancellationToken cancellationToken = default);

        /// <summary>
        /// Get deployment status
        /// </summary>
        Task<DeploymentStatus> GetDeploymentStatusAsync(string deploymentId, 
            CancellationToken cancellationToken = default);

        /// <summary>
        /// Validate deployment readiness
        /// </summary>
        Task<DeploymentValidationResult> ValidateDeploymentReadinessAsync(DeploymentValidationRequest request, 
            CancellationToken cancellationToken = default);

        /// <summary>
        /// Monitor production AI features
        /// </summary>
        Task<ProductionMonitoringReport> MonitorProductionFeaturesAsync(ProductionMonitoringRequest request, 
            CancellationToken cancellationToken = default);
    }

    /// <summary>
    /// ML feature management interface
    /// </summary>
    public interface IMLFeatureManagementService
    {
        /// <summary>
        /// Enable ML feature for users/groups
        /// </summary>
        Task<FeatureToggleResult> EnableMLFeatureAsync(MLFeatureToggleRequest request, 
            CancellationToken cancellationToken = default);

        /// <summary>
        /// Disable ML feature
        /// </summary>
        Task<FeatureToggleResult> DisableMLFeatureAsync(MLFeatureToggleRequest request, 
            CancellationToken cancellationToken = default);

        /// <summary>
        /// Get ML feature status for user
        /// </summary>
        Task<MLFeatureStatus> GetMLFeatureStatusAsync(string userId, string featureId, 
            CancellationToken cancellationToken = default);

        /// <summary>
        /// Configure feature rollout strategy
        /// </summary>
        Task<RolloutConfigurationResult> ConfigureFeatureRolloutAsync(FeatureRolloutRequest request, 
            CancellationToken cancellationToken = default);

        /// <summary>
        /// Get feature usage analytics
        /// </summary>
        Task<FeatureUsageAnalytics> GetFeatureUsageAnalyticsAsync(FeatureAnalyticsRequest request, 
            CancellationToken cancellationToken = default);
    }

    // ==========================================
    // WORKFLOW DATA TYPES
    // ==========================================

    /// <summary>
    /// ML workflow definition
    /// </summary>
    public class MLWorkflowDefinition
    {
        /// <summary>
        /// Workflow ID
        /// </summary>
        public string WorkflowId { get; set; } = string.Empty;

        /// <summary>
        /// Workflow name
        /// </summary>
        public string Name { get; set; } = string.Empty;

        /// <summary>
        /// Workflow description
        /// </summary>
        public string Description { get; set; } = string.Empty;

        /// <summary>
        /// Workflow type
        /// </summary>
        public MLWorkflowType Type { get; set; }

        /// <summary>
        /// Workflow steps
        /// </summary>
        public List<WorkflowStep> Steps { get; set; } = new();

        /// <summary>
        /// Required inputs
        /// </summary>
        public List<WorkflowInput> RequiredInputs { get; set; } = new();

        /// <summary>
        /// Expected outputs
        /// </summary>
        public List<WorkflowOutput> ExpectedOutputs { get; set; } = new();

        /// <summary>
        /// Workflow dependencies
        /// </summary>
        public List<string> Dependencies { get; set; } = new();

        /// <summary>
        /// Execution configuration
        /// </summary>
        public WorkflowExecutionConfiguration Configuration { get; set; } = new();

        /// <summary>
        /// Created timestamp
        /// </summary>
        public DateTimeOffset CreatedAt { get; set; } = DateTimeOffset.UtcNow;

        /// <summary>
        /// Updated timestamp
        /// </summary>
        public DateTimeOffset UpdatedAt { get; set; } = DateTimeOffset.UtcNow;

        /// <summary>
        /// Workflow version
        /// </summary>
        public string Version { get; set; } = "1.0";

        /// <summary>
        /// Is workflow active
        /// </summary>
        public bool IsActive { get; set; } = true;
    }

    /// <summary>
    /// Workflow step definition
    /// </summary>
    public class WorkflowStep
    {
        /// <summary>
        /// Step ID
        /// </summary>
        public string StepId { get; set; } = string.Empty;

        /// <summary>
        /// Step name
        /// </summary>
        public string Name { get; set; } = string.Empty;

        /// <summary>
        /// Step type
        /// </summary>
        public WorkflowStepType Type { get; set; }

        /// <summary>
        /// Step configuration
        /// </summary>
        public Dictionary<string, object> Configuration { get; set; } = new();

        /// <summary>
        /// Input mappings
        /// </summary>
        public List<InputMapping> InputMappings { get; set; } = new();

        /// <summary>
        /// Output mappings
        /// </summary>
        public List<OutputMapping> OutputMappings { get; set; } = new();

        /// <summary>
        /// Dependencies (previous steps)
        /// </summary>
        public List<string> DependsOn { get; set; } = new();

        /// <summary>
        /// Retry configuration
        /// </summary>
        public RetryConfiguration RetryConfig { get; set; } = new();

        /// <summary>
        /// Timeout configuration
        /// </summary>
        public TimeSpan? Timeout { get; set; }

        /// <summary>
        /// Step execution order
        /// </summary>
        public int ExecutionOrder { get; set; }

        /// <summary>
        /// Is step optional
        /// </summary>
        public bool IsOptional { get; set; } = false;

        /// <summary>
        /// Conditional execution rules
        /// </summary>
        public List<ConditionalRule> ConditionalRules { get; set; } = new();
    }

    /// <summary>
    /// Workflow execution status
    /// </summary>
    public class WorkflowExecutionStatus
    {
        /// <summary>
        /// Workflow execution ID
        /// </summary>
        public string ExecutionId { get; set; } = string.Empty;

        /// <summary>
        /// Workflow ID
        /// </summary>
        public string WorkflowId { get; set; } = string.Empty;

        /// <summary>
        /// Overall execution status
        /// </summary>
        public ExecutionStatus Status { get; set; }

        /// <summary>
        /// Current step being executed
        /// </summary>
        public string? CurrentStep { get; set; }

        /// <summary>
        /// Step execution statuses
        /// </summary>
        public List<StepExecutionStatus> StepStatuses { get; set; } = new();

        /// <summary>
        /// Execution progress (0-100)
        /// </summary>
        public double ProgressPercentage { get; set; }

        /// <summary>
        /// Start time
        /// </summary>
        public DateTimeOffset StartTime { get; set; }

        /// <summary>
        /// End time (if completed)
        /// </summary>
        public DateTimeOffset? EndTime { get; set; }

        /// <summary>
        /// Execution duration
        /// </summary>
        public TimeSpan? Duration { get; set; }

        /// <summary>
        /// Execution results
        /// </summary>
        public Dictionary<string, object> Results { get; set; } = new();

        /// <summary>
        /// Error information (if failed)
        /// </summary>
        public WorkflowError? Error { get; set; }

        /// <summary>
        /// Execution metrics
        /// </summary>
        public WorkflowExecutionMetrics Metrics { get; set; } = new();

        /// <summary>
        /// Resource usage
        /// </summary>
        public ResourceUsage ResourceUsage { get; set; } = new();
    }

    // ==========================================
    // AUTO-TRAINING PIPELINE TYPES
    // ==========================================

    /// <summary>
    /// Training pipeline configuration
    /// </summary>
    public class TrainingPipelineConfiguration
    {
        /// <summary>
        /// Pipeline ID
        /// </summary>
        public string PipelineId { get; set; } = string.Empty;

        /// <summary>
        /// Pipeline name
        /// </summary>
        public string Name { get; set; } = string.Empty;

        /// <summary>
        /// Target models for training
        /// </summary>
        public List<string> TargetModels { get; set; } = new();

        /// <summary>
        /// Data sources
        /// </summary>
        public List<TrainingDataSource> DataSources { get; set; } = new();

        /// <summary>
        /// Training schedule
        /// </summary>
        public TrainingSchedule Schedule { get; set; } = new();

        /// <summary>
        /// Training triggers
        /// </summary>
        public List<TrainingTrigger> Triggers { get; set; } = new();

        /// <summary>
        /// Quality thresholds
        /// </summary>
        public QualityThresholds QualityThresholds { get; set; } = new();

        /// <summary>
        /// Deployment automation
        /// </summary>
        public DeploymentAutomationConfig DeploymentConfig { get; set; } = new();

        /// <summary>
        /// Notification settings
        /// </summary>
        public TrainingNotificationSettings NotificationSettings { get; set; } = new();

        /// <summary>
        /// Resource allocation
        /// </summary>
        public TrainingResourceAllocation ResourceAllocation { get; set; } = new();

        /// <summary>
        /// Retention policy
        /// </summary>
        public ModelRetentionPolicy RetentionPolicy { get; set; } = new();
    }

    /// <summary>
    /// Training execution result
    /// </summary>
    public class TrainingExecutionResult
    {
        /// <summary>
        /// Execution ID
        /// </summary>
        public string ExecutionId { get; set; } = string.Empty;

        /// <summary>
        /// Pipeline ID
        /// </summary>
        public string PipelineId { get; set; } = string.Empty;

        /// <summary>
        /// Execution status
        /// </summary>
        public TrainingExecutionStatus Status { get; set; }

        /// <summary>
        /// Trained models
        /// </summary>
        public List<TrainedModelResult> TrainedModels { get; set; } = new();

        /// <summary>
        /// Training metrics
        /// </summary>
        public TrainingMetrics Metrics { get; set; } = new();

        /// <summary>
        /// Quality assessment
        /// </summary>
        public ModelQualityAssessment QualityAssessment { get; set; } = new();

        /// <summary>
        /// Performance benchmarks
        /// </summary>
        public PerformanceBenchmarks Benchmarks { get; set; } = new();

        /// <summary>
        /// Validation results
        /// </summary>
        public ValidationResults ValidationResults { get; set; } = new();

        /// <summary>
        /// Start time
        /// </summary>
        public DateTimeOffset StartTime { get; set; }

        /// <summary>
        /// End time
        /// </summary>
        public DateTimeOffset? EndTime { get; set; }

        /// <summary>
        /// Duration
        /// </summary>
        public TimeSpan? Duration { get; set; }

        /// <summary>
        /// Resource consumption
        /// </summary>
        public ResourceConsumption ResourceConsumption { get; set; } = new();

        /// <summary>
        /// Error details (if failed)
        /// </summary>
        public TrainingError? Error { get; set; }

        /// <summary>
        /// Recommendations for next training
        /// </summary>
        public List<TrainingRecommendation> Recommendations { get; set; } = new();
    }

    // ==========================================
    // PRODUCTION DEPLOYMENT TYPES
    // ==========================================

    /// <summary>
    /// Deployment configuration
    /// </summary>
    public class DeploymentConfiguration
    {
        /// <summary>
        /// Deployment ID
        /// </summary>
        public string DeploymentId { get; set; } = string.Empty;

        /// <summary>
        /// Deployment name
        /// </summary>
        public string Name { get; set; } = string.Empty;

        /// <summary>
        /// Target environment
        /// </summary>
        public DeploymentEnvironment Environment { get; set; }

        /// <summary>
        /// ML models to deploy
        /// </summary>
        public List<ModelDeploymentConfig> Models { get; set; } = new();

        /// <summary>
        /// Features to deploy
        /// </summary>
        public List<FeatureDeploymentConfig> Features { get; set; } = new();

        /// <summary>
        /// Deployment strategy
        /// </summary>
        public DeploymentStrategy Strategy { get; set; } = new();

        /// <summary>
        /// Rollback configuration
        /// </summary>
        public RollbackConfiguration RollbackConfig { get; set; } = new();

        /// <summary>
        /// Health checks
        /// </summary>
        public List<HealthCheck> HealthChecks { get; set; } = new();

        /// <summary>
        /// Monitoring configuration
        /// </summary>
        public MonitoringConfiguration MonitoringConfig { get; set; } = new();

        /// <summary>
        /// Security settings
        /// </summary>
        public DeploymentSecuritySettings SecuritySettings { get; set; } = new();

        /// <summary>
        /// Performance requirements
        /// </summary>
        public PerformanceRequirements PerformanceRequirements { get; set; } = new();
    }

    /// <summary>
    /// Deployment result
    /// </summary>
    public class DeploymentResult
    {
        /// <summary>
        /// Deployment execution ID
        /// </summary>
        public string ExecutionId { get; set; } = string.Empty;

        /// <summary>
        /// Deployment ID
        /// </summary>
        public string DeploymentId { get; set; } = string.Empty;

        /// <summary>
        /// Overall deployment status
        /// </summary>
        public DeploymentStatus Status { get; set; }

        /// <summary>
        /// Deployed models
        /// </summary>
        public List<DeployedModelInfo> DeployedModels { get; set; } = new();

        /// <summary>
        /// Deployed features
        /// </summary>
        public List<DeployedFeatureInfo> DeployedFeatures { get; set; } = new();

        /// <summary>
        /// Deployment endpoints
        /// </summary>
        public List<DeploymentEndpoint> Endpoints { get; set; } = new();

        /// <summary>
        /// Health check results
        /// </summary>
        public List<HealthCheckResult> HealthCheckResults { get; set; } = new();

        /// <summary>
        /// Performance metrics
        /// </summary>
        public DeploymentPerformanceMetrics PerformanceMetrics { get; set; } = new();

        /// <summary>
        /// Start time
        /// </summary>
        public DateTimeOffset StartTime { get; set; }

        /// <summary>
        /// End time
        /// </summary>
        public DateTimeOffset? EndTime { get; set; }

        /// <summary>
        /// Deployment duration
        /// </summary>
        public TimeSpan? Duration { get; set; }

        /// <summary>
        /// Deployment logs
        /// </summary>
        public List<DeploymentLogEntry> Logs { get; set; } = new();

        /// <summary>
        /// Error details (if failed)
        /// </summary>
        public DeploymentError? Error { get; set; }
    }

    // ==========================================
    // ML FEATURE MANAGEMENT TYPES
    // ==========================================

    /// <summary>
    /// ML feature definition
    /// </summary>
    public class MLFeatureDefinition
    {
        /// <summary>
        /// Feature ID
        /// </summary>
        public string FeatureId { get; set; } = string.Empty;

        /// <summary>
        /// Feature name
        /// </summary>
        public string Name { get; set; } = string.Empty;

        /// <summary>
        /// Feature description
        /// </summary>
        public string Description { get; set; } = string.Empty;

        /// <summary>
        /// Feature category
        /// </summary>
        public MLFeatureCategory Category { get; set; }

        /// <summary>
        /// Dependencies
        /// </summary>
        public List<string> Dependencies { get; set; } = new();

        /// <summary>
        /// Required models
        /// </summary>
        public List<string> RequiredModels { get; set; } = new();

        /// <summary>
        /// Feature flags
        /// </summary>
        public Dictionary<string, object> FeatureFlags { get; set; } = new();

        /// <summary>
        /// Rollout strategy
        /// </summary>
        public FeatureRolloutStrategy RolloutStrategy { get; set; } = new();

        /// <summary>
        /// Performance requirements
        /// </summary>
        public FeaturePerformanceRequirements PerformanceRequirements { get; set; } = new();

        /// <summary>
        /// Usage tracking configuration
        /// </summary>
        public UsageTrackingConfiguration UsageTracking { get; set; } = new();

        /// <summary>
        /// Feature version
        /// </summary>
        public string Version { get; set; } = "1.0";

        /// <summary>
        /// Created timestamp
        /// </summary>
        public DateTimeOffset CreatedAt { get; set; } = DateTimeOffset.UtcNow;

        /// <summary>
        /// Is feature enabled globally
        /// </summary>
        public bool IsGloballyEnabled { get; set; } = false;
    }

    /// <summary>
    /// ML feature status
    /// </summary>
    public class MLFeatureStatus
    {
        /// <summary>
        /// Feature ID
        /// </summary>
        public string FeatureId { get; set; } = string.Empty;

        /// <summary>
        /// User ID
        /// </summary>
        public string UserId { get; set; } = string.Empty;

        /// <summary>
        /// Is feature enabled for user
        /// </summary>
        public bool IsEnabled { get; set; }

        /// <summary>
        /// Rollout percentage
        /// </summary>
        public double RolloutPercentage { get; set; }

        /// <summary>
        /// User group assignments
        /// </summary>
        public List<string> UserGroups { get; set; } = new();

        /// <summary>
        /// Feature configuration overrides
        /// </summary>
        public Dictionary<string, object> ConfigurationOverrides { get; set; } = new();

        /// <summary>
        /// Last evaluation timestamp
        /// </summary>
        public DateTimeOffset LastEvaluated { get; set; }

        /// <summary>
        /// Feature metadata
        /// </summary>
        public FeatureMetadata Metadata { get; set; } = new();

        /// <summary>
        /// Usage statistics
        /// </summary>
        public FeatureUsageStats UsageStats { get; set; } = new();
    }

    // ==========================================
    // ENUMERATIONS
    // ==========================================

    public enum MLWorkflowType
    {
        DataProcessing,
        ModelTraining,
        ModelValidation,
        ModelDeployment,
        FeatureEngineering,
        QualityAssurance,
        PerformanceOptimization,
        AutomatedTesting,
        ComplianceValidation,
        MonitoringSetup
    }

    public enum WorkflowStepType
    {
        DataIngestion,
        DataValidation,
        DataTransformation,
        FeatureExtraction,
        ModelTraining,
        ModelValidation,
        ModelEvaluation,
        ModelDeployment,
        QualityCheck,
        PerformanceTest,
        SecurityScan,
        ComplianceCheck,
        NotificationSend,
        ReportGeneration
    }

    public enum ExecutionStatus
    {
        Pending,
        Running,
        Completed,
        Failed,
        Cancelled,
        Paused,
        Retrying,
        Skipped
    }

    public enum TrainingExecutionStatus
    {
        Queued,
        DataPreparation,
        Training,
        Validation,
        QualityAssessment,
        Completed,
        Failed,
        Cancelled
    }

    public enum DeploymentEnvironment
    {
        Development,
        Staging,
        Production,
        Testing,
        PreProduction
    }

    public enum DeploymentStatus
    {
        Preparing,
        InProgress,
        Validating,
        Completed,
        Failed,
        RolledBack,
        PartiallyDeployed
    }

    public enum MLFeatureCategory
    {
        RequirementAnalysis,
        TestGeneration,
        CoverageAnalysis,
        QualityPrediction,
        PerformanceOptimization,
        RiskAssessment,
        AutomatedInsights,
        PredictiveAnalytics,
        AnomalyDetection,
        NaturalLanguageProcessing
    }

    // ==========================================
    // REQUEST TYPES
    // ==========================================

    public class MLWorkflowInitializationRequest
    {
        public string ProjectId { get; set; } = string.Empty;
        public List<MLWorkflowType> WorkflowTypes { get; set; } = new();
        public Dictionary<string, object> Configuration { get; set; } = new();
        public bool EnableAutomation { get; set; } = true;
        public List<string> RequiredFeatures { get; set; } = new();
    }

    public class WorkflowStepRequest
    {
        public string WorkflowExecutionId { get; set; } = string.Empty;
        public string StepId { get; set; } = string.Empty;
        public Dictionary<string, object> InputData { get; set; } = new();
        public Dictionary<string, object> StepConfiguration { get; set; } = new();
    }

    public class AutomationTriggerRequest
    {
        public string ProjectId { get; set; } = string.Empty;
        public List<string> TriggerEvents { get; set; } = new();
        public Dictionary<string, object> TriggerData { get; set; } = new();
        public bool ForceExecution { get; set; } = false;
    }

    public class PipelineSetupRequest
    {
        public string ProjectId { get; set; } = string.Empty;
        public TrainingPipelineConfiguration Configuration { get; set; } = new();
        public bool EnableImmediateExecution { get; set; } = false;
        public List<string> NotificationRecipients { get; set; } = new();
    }

    public class TrainingPipelineRequest
    {
        public string PipelineId { get; set; } = string.Empty;
        public string TriggerReason { get; set; } = string.Empty;
        public Dictionary<string, object> OverrideConfiguration { get; set; } = new();
        public bool ValidateBeforeTraining { get; set; } = true;
        public List<string> TargetModels { get; set; } = new();
    }

    public class DeploymentRequest
    {
        public DeploymentConfiguration Configuration { get; set; } = new();
        public bool ValidateBeforeDeployment { get; set; } = true;
        public bool EnableRollbackOnFailure { get; set; } = true;
        public List<string> NotificationRecipients { get; set; } = new();
    }

    public class MLFeatureToggleRequest
    {
        public string FeatureId { get; set; } = string.Empty;
        public List<string> UserIds { get; set; } = new();
        public List<string> UserGroups { get; set; } = new();
        public double RolloutPercentage { get; set; } = 0;
        public Dictionary<string, object> Configuration { get; set; } = new();
        public string Reason { get; set; } = string.Empty;
    }

    // ==========================================
    // SUPPORTING TYPES
    // ==========================================

    public class WorkflowInput
    {
        public string Name { get; set; } = string.Empty;
        public string Type { get; set; } = string.Empty;
        public bool IsRequired { get; set; } = true;
        public object? DefaultValue { get; set; }
        public string Description { get; set; } = string.Empty;
        public List<string> AllowedValues { get; set; } = new();
    }

    public class WorkflowOutput
    {
        public string Name { get; set; } = string.Empty;
        public string Type { get; set; } = string.Empty;
        public string Description { get; set; } = string.Empty;
        public Dictionary<string, object> Metadata { get; set; } = new();
    }

    public class WorkflowExecutionConfiguration
    {
        public int MaxRetries { get; set; } = 3;
        public TimeSpan DefaultTimeout { get; set; } = TimeSpan.FromMinutes(30);
        public bool EnableParallelExecution { get; set; } = true;
        public ResourceLimits ResourceLimits { get; set; } = new();
        public List<string> RequiredPermissions { get; set; } = new();
        public Dictionary<string, object> EnvironmentVariables { get; set; } = new();
    }

    public class InputMapping
    {
        public string SourceField { get; set; } = string.Empty;
        public string TargetField { get; set; } = string.Empty;
        public string? Transformation { get; set; }
    }

    public class OutputMapping
    {
        public string SourceField { get; set; } = string.Empty;
        public string TargetField { get; set; } = string.Empty;
        public string? Transformation { get; set; }
    }

    public class RetryConfiguration
    {
        public int MaxAttempts { get; set; } = 3;
        public TimeSpan InitialDelay { get; set; } = TimeSpan.FromSeconds(5);
        public double BackoffMultiplier { get; set; } = 2.0;
        public TimeSpan MaxDelay { get; set; } = TimeSpan.FromMinutes(5);
        public List<string> RetriableErrors { get; set; } = new();
    }

    public class ConditionalRule
    {
        public string Condition { get; set; } = string.Empty;
        public string Action { get; set; } = string.Empty;
        public Dictionary<string, object> Parameters { get; set; } = new();
    }

    public class StepExecutionStatus
    {
        public string StepId { get; set; } = string.Empty;
        public ExecutionStatus Status { get; set; }
        public DateTimeOffset StartTime { get; set; }
        public DateTimeOffset? EndTime { get; set; }
        public TimeSpan? Duration { get; set; }
        public Dictionary<string, object> Outputs { get; set; } = new();
        public string? ErrorMessage { get; set; }
        public int RetryCount { get; set; }
    }
}
    public class TestOptimizationRequest { public string Strategy { get; set; } = string.Empty; }
    public class TestPrioritizationContext { public List<string> Priorities { get; set; } = new(); }
    public class RedundancyAnalysisContext { public List<string> TestIds { get; set; } = new(); }
    public class ConsolidationAnalysisContext { public string Strategy { get; set; } = string.Empty; }
    public class TestConsolidation { public List<string> ConsolidatedTests { get; set; } = new(); }
    public class OptimizedTestSuite { public List<string> TestIds { get; set; } = new(); }
    public class OptimizationStatistics { public double ImprovementPercentage { get; set; } }
    public class PerformanceImprovements { public TimeSpan TimeSaved { get; set; } }
    public class OptimizationRiskAnalysis { public double RiskScore { get; set; } }
    public class OptimizationRecommendation { public string Recommendation { get; set; } = string.Empty; }
    public class PriorityFactor { public string Name { get; set; } = string.Empty; public double Weight { get; set; } }
    public class BusinessImpact { public double Score { get; set; } }
    public class TechnicalRisk { public double RiskLevel { get; set; } }
    public class ExecutionCost { public double Cost { get; set; } }
    public class SimilarTest { public string TestId { get; set; } = string.Empty; }
    public class RemovalImpact { public double ImpactScore { get; set; } }

    // Additional ML Training Types
    public class MLTrainingData { public string Data { get; set; } = string.Empty; }
    public class MLTrainingResult { public bool IsSuccessful { get; set; } }
    public class MLTrainingMetrics { public double Accuracy { get; set; } }



    public class MLModel
    {
        public string Id { get; set; } = string.Empty;
        public string Name { get; set; } = string.Empty;
        public Dictionary<string, object> Parameters { get; set; } = new();
    }



    public class HealthCheckContext
    {
        public string CheckName { get; set; } = string.Empty;
        public Dictionary<string, object> Properties { get; set; } = new();
    }

    public enum HealthStatus
    {
        Healthy,
        Degraded,
        Unhealthy
    }



    // ML Feature types that were missing
    public class MLFeatureToggleResult
    {
        public bool IsEnabled { get; set; }
        public string FeatureId { get; set; } = string.Empty;
        public Dictionary<string, object> Properties { get; set; } = new();
    }

    public interface IValidationService
    {
        Task<ValidationResult> ValidateAsync<T>(T item);
    }

    public interface IMetricsCollector
    {
        void RecordMetric(string name, double value);
    }

    public interface ICacheService
    {
        Task<T?> GetAsync<T>(string key);
        Task SetAsync<T>(string key, T value);
    }



    public class BulkUpdateInput
    {
        public List<string> Ids { get; set; } = new();
        public Dictionary<string, object> Updates { get; set; } = new();
    }

    public class User
    {
        public string Id { get; set; } = string.Empty;
        public string Name { get; set; } = string.Empty;
        public List<string> Roles { get; set; } = new();
    }

    // Additional ASP.NET Core placeholder types
    public interface IHealthCheck
    {
        Task<HealthCheckResult> CheckHealthAsync(HealthCheckContext context, CancellationToken cancellationToken = default);
    }

    public class HealthCheckResult
    {
        public string Name { get; set; } = string.Empty;
        public HealthStatus Status { get; set; }
        public string? Description { get; set; }
        public Exception? Exception { get; set; }
        public bool IsHealthy { get; set; }
        public string? ErrorMessage { get; set; }
        public DateTimeOffset CheckedAt { get; set; }

        public static HealthCheckResult Healthy(string? description = null) =>
            new HealthCheckResult { Status = HealthStatus.Healthy, Description = description, IsHealthy = true };

        public static HealthCheckResult Unhealthy(string? description = null, Exception? exception = null) =>
            new HealthCheckResult { Status = HealthStatus.Unhealthy, Description = description, Exception = exception, IsHealthy = false };
    }

    public interface IApplicationBuilder
    {
        IApplicationBuilder Use(Func<HttpContext, Func<Task>, Task> middleware);
        IApplicationBuilder UseMiddleware<T>();
        IServiceProvider ApplicationServices { get; }
    }

    public class HttpContext
    {
        public HttpRequest Request { get; set; } = new();
        public HttpResponse Response { get; set; } = new();
        public Dictionary<object, object?> Items { get; set; } = new();
    }

    public class HttpRequest
    {
        public string Path { get; set; } = string.Empty;
        public string Method { get; set; } = string.Empty;
        public Dictionary<string, string> Headers { get; set; } = new();
    }

    public class HttpResponse
    {
        public int StatusCode { get; set; }
        public Dictionary<string, string> Headers { get; set; } = new();
    }



    public interface IHubContext<THub, T>
    {
        Task SendAllAsync(string method, object data);
    }

    public class Hub<T>
    {
        public string ConnectionId { get; set; } = string.Empty;
    }



    // System.Reactive placeholder types
    public class Subject<T> : IDisposable
    {
        public void OnNext(T value) { }
        public void OnError(Exception error) { }
        public void OnCompleted() { }
        public void Dispose() { }
    }

    // Polly placeholder types
    public interface IAsyncPolicy
    {
        Task<TResult> ExecuteAsync<TResult>(Func<Task<TResult>> action);
    }

    // Training types for ML workflows
    public class TrainingError
    {
        public string ErrorCode { get; set; } = string.Empty;
        public string Message { get; set; } = string.Empty;
        public Exception? Exception { get; set; }
    }

    // Feature management types
    public class FeatureToggleResult
    {
        public bool IsEnabled { get; set; }
        public bool IsSuccessful { get; set; }
        public string FeatureId { get; set; } = string.Empty;
        public Dictionary<string, object> Properties { get; set; } = new();
    }

    public class ABTestConfiguration
    {
        public string TestId { get; set; } = string.Empty;
        public string VariantId { get; set; } = string.Empty;
        public double TrafficPercentage { get; set; }
    }

    public class ABTestResult
    {
        public string TestId { get; set; } = string.Empty;
        public string WinningVariant { get; set; } = string.Empty;
        public double ConfidenceScore { get; set; }
    }

    public class FeatureDependency
    {
        public string FeatureId { get; set; } = string.Empty;
        public string DependsOn { get; set; } = string.Empty;
        public string DependencyType { get; set; } = string.Empty;
    }

    public class RolloutConfigurationResult
    {
        public string ConfigurationId { get; set; } = string.Empty;
        public bool IsSuccessful { get; set; }
    }

    public class FeatureRolloutStrategy
    {
        public string StrategyType { get; set; } = string.Empty;
        public Dictionary<string, object> Parameters { get; set; } = new();
    }

    public class FeaturePerformanceRequirements
    {
        public TimeSpan MaxLatency { get; set; }
        public double MinThroughput { get; set; }
    }

    public class UsageTrackingConfiguration
    {
        public bool TrackUsage { get; set; }
        public List<string> MetricsToTrack { get; set; } = new();
    }

    public class FeatureMetadata
    {
        public string Name { get; set; } = string.Empty;
        public string Description { get; set; } = string.Empty;
        public Dictionary<string, object> Tags { get; set; } = new();
    }

    public class FeatureUsageStats
    {
        public int TotalUsage { get; set; }
        public Dictionary<string, int> UsageByRegion { get; set; } = new();
    }
    // End of ML Workflow Types
}